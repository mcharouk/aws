# Policy generator & Simulator Demo

## Policy Generator

* [Policy Generator](https://awspolicygen.s3.amazonaws.com/policygen.html)
* Create a Policy 
  * select IAM Policy
  * AWS Lambda (case sensitive) 
  * that allows createFunction, UpdateFunction and getFunction
  * Resource 
  ```
  arn:aws:lambda:eu-west-3::function:dev-*
  ```
  * Condition
    * StringEquals
    * aws:ResourceTag/${TagKey}
    * ProjectA
  * Click on Add Statement
  * Click on Generate Policy
  * Replace TagKey with Project

## Policy Simulator

### Deactivate SCP

* SCP that have conditions does not work on Policy Simulator. In my case, it's better to deactivate them
* On Top right select Mode : Existing Policies
* Select any role
* uncheck the box *AWS Organization SCPs*

### Simulate the policy

* [Policy Simulator](https://policysim.aws.amazon.com/)
  * On Top right select Mode : New Policy
  * copy/paste policy generated by simulator
  * click on Apply (scroll down a little bit)
  * select Lambda service and some action (CreateFunction)
  * in Global context put ProjectA
  * in Resource
    
```
arn:aws:lambda:eu-west-3::function:dev-myFunction
```
  * this should succeed, change some parameters to make it fail (TagName, Region, Action, ResourceName, etc...)

